name: Bore-RDP-Free
on: workflow_dispatch

jobs:
  rdp:
    runs-on: windows-latest
    steps:
    - name: Setup Windows & User
      run: |
        # Enable RDP and allow connections
        Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0
        Enable-NetFirewallRule -DisplayGroup "Remote Desktop"
        # Create user NoahNW with your password
        net user NoahNW "Iloveriley123$" /add
        net localgroup Administrators NoahNW /add

    - name: Download and Start Bore
      run: |
        # Download the Bore tool
        Invoke-WebRequest https://github.com/ekzhang/bore/releases/latest/download/bore-v0.5.1-x86_64-pc-windows-msvc.zip -OutFile bore.zip
        Expand-Archive bore.zip -DestinationPath .
        
        Write-Host "--- TUNNEL STARTING ---"
        # This connects local port 3389 to the public bore.pub server
        .\bore.exe local 3389 --to bore.pub
